
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../simulation/">
      
      
        <link rel="next" href="../visualization/">
      
      
      <link rel="icon" href="../../img/squid_drawing.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.22">
    
    
      
        <title>test_setups - Olfactory Navigation Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.732c4fb1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#olfactory_navigation.test_setups" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Olfactory Navigation Documentation" class="md-header__button md-logo" aria-label="Olfactory Navigation Documentation" data-md-component="logo">
      
  <img src="../../img/squid_drawing.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Olfactory Navigation Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              test_setups
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/PimLb/olfactory-navigation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Code Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../agent_creation/" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Olfactory Navigation Documentation" class="md-nav__button md-logo" aria-label="Olfactory Navigation Documentation" data-md-component="logo">
      
  <img src="../../img/squid_drawing.png" alt="logo">

    </a>
    Olfactory Navigation Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PimLb/olfactory-navigation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Code Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    olfactory_navigation
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            olfactory_navigation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../agents/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    agents
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            agents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/fsvi_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fsvi_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/hsvi_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hsvi_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/infotaxis_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    infotaxis_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../agents/model_based_util/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    model_based_util
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_2_4" id="__nav_2_1_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1_2_4">
            <span class="md-nav__icon md-icon"></span>
            model_based_util
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/model_based_util/belief/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    belief
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/model_based_util/belief_value_mapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    belief_value_mapping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/model_based_util/environment_converter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    environment_converter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/model_based_util/mdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mdp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/model_based_util/pomdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pomdp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/model_based_util/value_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    value_function
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/model_based_util/vi_solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vi_solver
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/pbvi_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/pbvi_ger_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_ger_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/pbvi_ra_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_ra_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/pbvi_ssea_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_ssea_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/pbvi_ssga_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_ssga_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/pbvi_ssra_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_ssra_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/perseus_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perseus_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/q_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    q_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agents/qmdp_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qmdp_agent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../build_environment_gui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    build_environment_gui
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    simulation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    test_setups
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    test_setups
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups" class="md-nav__link">
    <span class="md-ellipsis">
      test_setups
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.analyse_scale_robustness" class="md-nav__link">
    <span class="md-ellipsis">
      analyse_scale_robustness
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.analyse_shape_robustness" class="md-nav__link">
    <span class="md-ellipsis">
      analyse_shape_robustness
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.run_all_starts_test" class="md-nav__link">
    <span class="md-ellipsis">
      run_all_starts_test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.run_n_by_cell_test" class="md-nav__link">
    <span class="md-ellipsis">
      run_n_by_cell_test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.test_scale_robustness" class="md-nav__link">
    <span class="md-ellipsis">
      test_scale_robustness
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.test_shape_robustness" class="md-nav__link">
    <span class="md-ellipsis">
      test_shape_robustness
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    visualization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../agent_creation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Create an Agent?
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups" class="md-nav__link">
    <span class="md-ellipsis">
      test_setups
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.analyse_scale_robustness" class="md-nav__link">
    <span class="md-ellipsis">
      analyse_scale_robustness
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.analyse_shape_robustness" class="md-nav__link">
    <span class="md-ellipsis">
      analyse_shape_robustness
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.run_all_starts_test" class="md-nav__link">
    <span class="md-ellipsis">
      run_all_starts_test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.run_n_by_cell_test" class="md-nav__link">
    <span class="md-ellipsis">
      run_n_by_cell_test
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.test_scale_robustness" class="md-nav__link">
    <span class="md-ellipsis">
      test_scale_robustness
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.test_setups.test_shape_robustness" class="md-nav__link">
    <span class="md-ellipsis">
      test_shape_robustness
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>test_setups</h1>

<div class="doc doc-object doc-module">



<a id="olfactory_navigation.test_setups"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h2 id="olfactory_navigation.test_setups.analyse_scale_robustness" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">analyse_scale_robustness</span><span class="p">(</span><span class="n">all_histories</span><span class="p">,</span> <span class="n">multipliers</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function to generate an analysis of a set of simulation tests with different multipliers applied in the environment.
It returns a pandas dataframe summarizing the results for each multiplier pairs.
The results analyzed are the following:</p>
<ul>
<li>convergence</li>
<li>steps taken</li>
<li>discounted rewards</li>
<li>extra steps taken (compared to a minimum path)</li>
<li>t min over t (a ratio of how optimal the path taken was)</li>
</ul>
<p>For each result, the mean, standard deviation along with the mean and standard deviation of the successful trajectories are recorded. </p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>all_histories</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="olfactory_navigation.simulation.SimulationHistory" href="../simulation/#olfactory_navigation.simulation.SimulationHistory">SimulationHistory</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of all the simulation histories to summarize</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>multipliers</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An array of the multiplier pairs used (for the y multiplier then the x multiplier)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>df</code></td>          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The analysis dataframe.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\test_setups.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">analyse_scale_robustness</span><span class="p">(</span><span class="n">all_histories</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SimulationHistory</span><span class="p">],</span>
                             <span class="n">multipliers</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
                             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to generate an analysis of a set of simulation tests with different multipliers applied in the environment.</span>
<span class="sd">    It returns a pandas dataframe summarizing the results for each multiplier pairs.</span>
<span class="sd">    The results analyzed are the following:</span>

<span class="sd">    - convergence</span>
<span class="sd">    - steps taken</span>
<span class="sd">    - discounted rewards</span>
<span class="sd">    - extra steps taken (compared to a minimum path)</span>
<span class="sd">    - t min over t (a ratio of how optimal the path taken was)</span>

<span class="sd">    For each result, the mean, standard deviation along with the mean and standard deviation of the successful trajectories are recorded. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    all_histories : list[SimulationHistory]</span>
<span class="sd">        A list of all the simulation histories to summarize</span>
<span class="sd">    multipliers : np.ndarray</span>
<span class="sd">        An array of the multiplier pairs used (for the y multiplier then the x multiplier)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        The analysis dataframe.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For each simulation history and multiplier, the analysis dataframe is extracted</span>
    <span class="k">for</span> <span class="n">hist</span><span class="p">,</span> <span class="n">multiplier</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_histories</span><span class="p">,</span> <span class="n">multipliers</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">analysis_df</span>

        <span class="c1"># Then the summarized metrics are collapsed on a single row</span>
        <span class="n">col_metric_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;multiplier&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">multiplier</span><span class="p">)}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;converged&#39;</span><span class="p">,</span> <span class="s1">&#39;reached_horizon&#39;</span><span class="p">,</span> <span class="s1">&#39;steps_taken&#39;</span><span class="p">,</span> <span class="s1">&#39;discounted_rewards&#39;</span><span class="p">,</span> <span class="s1">&#39;extra_steps&#39;</span><span class="p">,</span> <span class="s1">&#39;t_min_over_t&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;standard_deviation&#39;</span><span class="p">,</span> <span class="s1">&#39;success_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;success_standard_deviation&#39;</span><span class="p">]:</span>
                <span class="n">col_metric_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metric</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>

        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col_metric_dict</span><span class="p">)</span>

    <span class="c1"># Creating the dataframe from all the rows</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

    <span class="c1"># Removal of 4 unnecessary columns</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;converged_success_mean&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;converged_success_standard_deviation&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;reached_horizon_success_mean&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;reached_horizon_success_standard_deviation&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="olfactory_navigation.test_setups.analyse_shape_robustness" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">analyse_shape_robustness</span><span class="p">(</span><span class="n">all_histories</span><span class="p">,</span> <span class="n">multipliers</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function to generate an analysis of a set of simulation tests with different multipliers applied in the environment.
It returns a pandas dataframe summarizing the results for each multiplier pairs.
The results analyzed are the following:</p>
<ul>
<li>convergence</li>
<li>steps taken</li>
<li>discounted rewards</li>
<li>extra steps taken (compared to a minimum path)</li>
<li>t min over t (a ratio of how optimal the path taken was)</li>
</ul>
<p>For each result, the mean, standard deviation along with the mean and standard deviation of the successful trajectories are recorded. </p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>all_histories</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="olfactory_navigation.simulation.SimulationHistory" href="../simulation/#olfactory_navigation.simulation.SimulationHistory">SimulationHistory</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of all the simulation histories to summarize</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>multipliers</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An array of the multiplier pairs used (for the y multiplier then the x multiplier)</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>df</code></td>          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The analysis dataframe.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\test_setups.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">analyse_shape_robustness</span><span class="p">(</span><span class="n">all_histories</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">SimulationHistory</span><span class="p">],</span>
                             <span class="n">multipliers</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
                             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to generate an analysis of a set of simulation tests with different multipliers applied in the environment.</span>
<span class="sd">    It returns a pandas dataframe summarizing the results for each multiplier pairs.</span>
<span class="sd">    The results analyzed are the following:</span>

<span class="sd">    - convergence</span>
<span class="sd">    - steps taken</span>
<span class="sd">    - discounted rewards</span>
<span class="sd">    - extra steps taken (compared to a minimum path)</span>
<span class="sd">    - t min over t (a ratio of how optimal the path taken was)</span>

<span class="sd">    For each result, the mean, standard deviation along with the mean and standard deviation of the successful trajectories are recorded. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    all_histories : list[SimulationHistory]</span>
<span class="sd">        A list of all the simulation histories to summarize</span>
<span class="sd">    multipliers : np.ndarray</span>
<span class="sd">        An array of the multiplier pairs used (for the y multiplier then the x multiplier)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df : pd.DataFrame</span>
<span class="sd">        The analysis dataframe.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># For each simulation history and multiplier, the analysis dataframe is extracted</span>
    <span class="k">for</span> <span class="n">hist</span><span class="p">,</span> <span class="n">multiplier_pair</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">all_histories</span><span class="p">,</span> <span class="n">multipliers</span><span class="p">):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">analysis_df</span>

        <span class="c1"># Then the summarized metrics are collapsed on a single row</span>
        <span class="n">col_metric_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;y_multiplier&#39;</span><span class="p">:</span> <span class="n">multiplier_pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="s1">&#39;x_multiplier&#39;</span><span class="p">:</span> <span class="n">multiplier_pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)}</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;converged&#39;</span><span class="p">,</span> <span class="s1">&#39;reached_horizon&#39;</span><span class="p">,</span> <span class="s1">&#39;steps_taken&#39;</span><span class="p">,</span> <span class="s1">&#39;discounted_rewards&#39;</span><span class="p">,</span> <span class="s1">&#39;extra_steps&#39;</span><span class="p">,</span> <span class="s1">&#39;t_min_over_t&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;standard_deviation&#39;</span><span class="p">,</span> <span class="s1">&#39;success_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;success_standard_deviation&#39;</span><span class="p">]:</span>
                <span class="n">col_metric_dict</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">metric</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>

        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col_metric_dict</span><span class="p">)</span>

    <span class="c1"># Creating the dataframe from all the rows</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

    <span class="c1"># Removal of 4 unnecessary columns</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;converged_success_mean&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;converged_success_standard_deviation&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;reached_horizon_success_mean&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;reached_horizon_success_standard_deviation&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">df</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="olfactory_navigation.test_setups.run_all_starts_test" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_all_starts_test</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">environment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_shift</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_loop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">reward_discount</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">print_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function to run a test with all the available starting positions based on the environment provided (or the environmnent of the agent).</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>agent</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agent.Agent" href="../agent/#olfactory_navigation.agent.Agent">Agent</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The agent to be tested</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>environment</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.environment.Environment" href="../environment/#olfactory_navigation.environment.Environment">Environment</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The environment to run the simulations in.
By default, the environment linked to the agent will used.
This parameter is intended if the environment needs to be modified compared to environment the agent was trained on.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>time_shift</code></td>
          <td>
                <code>int or <span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The time at which to start the olfactory simulation array.
It can be either a single value, or n values.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>time_loop</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to loop the time if reaching the end. (starts back at 0)</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>horizon</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The amount of steps to run the simulation for before killing the remaining simulations.</p>
            </div>
          </td>
          <td>
                <code>1000</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>reward_discount</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>How much a given reward is discounted based on how long it took to get it.
It is purely used to compute the Average Discount Reward (ADR) after the simulation.</p>
            </div>
          </td>
          <td>
                <code>0.99</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>print_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Wheter to show a progress bar of what step the simulations are at.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>print_stats</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Wheter to print the stats at the end of the run.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>use_gpu</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to run the simulations on the GPU or not.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>hist</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.simulation.SimulationHistory" href="../simulation/#olfactory_navigation.simulation.SimulationHistory">SimulationHistory</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A SimulationHistory object that tracked all the positions, actions and observations.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\test_setups.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_all_starts_test</span><span class="p">(</span>
             <span class="n">agent</span><span class="p">:</span> <span class="n">Agent</span><span class="p">,</span>
             <span class="n">environment</span><span class="p">:</span> <span class="n">Environment</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">time_shift</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">time_loop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
             <span class="n">reward_discount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.99</span><span class="p">,</span>
             <span class="n">print_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">print_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">use_gpu</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimulationHistory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to run a test with all the available starting positions based on the environment provided (or the environmnent of the agent).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    agent : Agent</span>
<span class="sd">        The agent to be tested</span>
<span class="sd">    environment : Environment, optional</span>
<span class="sd">        The environment to run the simulations in.</span>
<span class="sd">        By default, the environment linked to the agent will used.</span>
<span class="sd">        This parameter is intended if the environment needs to be modified compared to environment the agent was trained on.</span>
<span class="sd">    time_shift : int or np.ndarray, default=0</span>
<span class="sd">        The time at which to start the olfactory simulation array.</span>
<span class="sd">        It can be either a single value, or n values.</span>
<span class="sd">    time_loop : bool, default=True</span>
<span class="sd">        Whether to loop the time if reaching the end. (starts back at 0)</span>
<span class="sd">    horizon : int, default=1000</span>
<span class="sd">        The amount of steps to run the simulation for before killing the remaining simulations.</span>
<span class="sd">    reward_discount : float, default=0.99</span>
<span class="sd">        How much a given reward is discounted based on how long it took to get it.</span>
<span class="sd">        It is purely used to compute the Average Discount Reward (ADR) after the simulation.</span>
<span class="sd">    print_progress : bool, default=True</span>
<span class="sd">        Wheter to show a progress bar of what step the simulations are at.</span>
<span class="sd">    print_stats : bool, default=True</span>
<span class="sd">        Wheter to print the stats at the end of the run.</span>
<span class="sd">    use_gpu : bool, default=False</span>
<span class="sd">        Whether to run the simulations on the GPU or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    hist : SimulationHistory</span>
<span class="sd">        A SimulationHistory object that tracked all the positions, actions and observations.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Handle the case an specific environment is given</span>
    <span class="n">environment_provided</span> <span class="o">=</span> <span class="n">environment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">environment_provided</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">environment</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">agent</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;The provided environment&#39;s shape doesn&#39;t match the environment has been trained on...&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">environment</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">environment</span>

    <span class="c1"># Gathering starting points</span>
    <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">start_probabilities</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">start_points</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">run_test</span><span class="p">(</span>
        <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">start_points</span><span class="o">=</span><span class="n">start_points</span><span class="p">,</span>
        <span class="n">environment</span><span class="o">=</span><span class="n">environment</span> <span class="k">if</span> <span class="n">environment_provided</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">time_shift</span><span class="o">=</span><span class="n">time_shift</span><span class="p">,</span>
        <span class="n">time_loop</span><span class="o">=</span><span class="n">time_loop</span><span class="p">,</span>
        <span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span>
        <span class="n">reward_discount</span><span class="o">=</span><span class="n">reward_discount</span><span class="p">,</span>
        <span class="n">print_progress</span><span class="o">=</span><span class="n">print_progress</span><span class="p">,</span>
        <span class="n">print_stats</span><span class="o">=</span><span class="n">print_stats</span><span class="p">,</span>
        <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="olfactory_navigation.test_setups.run_n_by_cell_test" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">run_n_by_cell_test</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">cell_width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_by_cell</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">environment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_shift</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_loop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">reward_discount</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">print_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function to run a test with simulations starting in different cells across the available starting zones.
A number n_by_cell determines how many simulations should start within each cell (the same position can be chosen multiple times).</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>agent</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agent.Agent" href="../agent/#olfactory_navigation.agent.Agent">Agent</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The agent to be tested</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>cell_width</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The size of the sides of each cells to be considered.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>n_by_cell</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>How many simulations should start within each cell.</p>
            </div>
          </td>
          <td>
                <code>10</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>environment</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.environment.Environment" href="../environment/#olfactory_navigation.environment.Environment">Environment</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The environment to run the simulations in.
By default, the environment linked to the agent will used.
This parameter is intended if the environment needs to be modified compared to environment the agent was trained on.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>time_shift</code></td>
          <td>
                <code>int or <span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The time at which to start the olfactory simulation array.
It can be either a single value, or n values.</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>time_loop</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to loop the time if reaching the end. (starts back at 0)</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>horizon</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The amount of steps to run the simulation for before killing the remaining simulations.</p>
            </div>
          </td>
          <td>
                <code>1000</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>reward_discount</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>How much a given reward is discounted based on how long it took to get it.
It is purely used to compute the Average Discount Reward (ADR) after the simulation.</p>
            </div>
          </td>
          <td>
                <code>0.99</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>print_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Wheter to show a progress bar of what step the simulations are at.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>print_stats</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Wheter to print the stats at the end of the run.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>use_gpu</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to run the simulations on the GPU or not.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>hist</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.simulation.SimulationHistory" href="../simulation/#olfactory_navigation.simulation.SimulationHistory">SimulationHistory</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A SimulationHistory object that tracked all the positions, actions and observations.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\test_setups.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_n_by_cell_test</span><span class="p">(</span>
             <span class="n">agent</span><span class="p">:</span> <span class="n">Agent</span><span class="p">,</span>
             <span class="n">cell_width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
             <span class="n">n_by_cell</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
             <span class="n">environment</span><span class="p">:</span> <span class="n">Environment</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">time_shift</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">time_loop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">horizon</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
             <span class="n">reward_discount</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.99</span><span class="p">,</span>
             <span class="n">print_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">print_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">use_gpu</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
             <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SimulationHistory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to run a test with simulations starting in different cells across the available starting zones.</span>
<span class="sd">    A number n_by_cell determines how many simulations should start within each cell (the same position can be chosen multiple times).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    agent : Agent</span>
<span class="sd">        The agent to be tested</span>
<span class="sd">    cell_width : int, default=10</span>
<span class="sd">        The size of the sides of each cells to be considered.</span>
<span class="sd">    n_by_cell : int, default=10</span>
<span class="sd">        How many simulations should start within each cell.</span>
<span class="sd">    environment : Environment, optional</span>
<span class="sd">        The environment to run the simulations in.</span>
<span class="sd">        By default, the environment linked to the agent will used.</span>
<span class="sd">        This parameter is intended if the environment needs to be modified compared to environment the agent was trained on.</span>
<span class="sd">    time_shift : int or np.ndarray, default=0</span>
<span class="sd">        The time at which to start the olfactory simulation array.</span>
<span class="sd">        It can be either a single value, or n values.</span>
<span class="sd">    time_loop : bool, default=True</span>
<span class="sd">        Whether to loop the time if reaching the end. (starts back at 0)</span>
<span class="sd">    horizon : int, default=1000</span>
<span class="sd">        The amount of steps to run the simulation for before killing the remaining simulations.</span>
<span class="sd">    reward_discount : float, default=0.99</span>
<span class="sd">        How much a given reward is discounted based on how long it took to get it.</span>
<span class="sd">        It is purely used to compute the Average Discount Reward (ADR) after the simulation.</span>
<span class="sd">    print_progress : bool, default=True</span>
<span class="sd">        Wheter to show a progress bar of what step the simulations are at.</span>
<span class="sd">    print_stats : bool, default=True</span>
<span class="sd">        Wheter to print the stats at the end of the run.</span>
<span class="sd">    use_gpu : bool, default=False</span>
<span class="sd">        Whether to run the simulations on the GPU or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    hist : SimulationHistory</span>
<span class="sd">        A SimulationHistory object that tracked all the positions, actions and observations.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Handle the case an specific environment is given</span>
    <span class="n">environment_provided</span> <span class="o">=</span> <span class="n">environment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="n">environment_provided</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">environment</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">agent</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot;The provided environment&#39;s shape doesn&#39;t match the environment has been trained on...&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">environment</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">environment</span>

    <span class="c1"># Gathering starting points</span>
    <span class="n">cells_x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">cell_width</span><span class="p">)</span>
    <span class="n">cells_y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">cell_width</span><span class="p">)</span>

    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">indices_grid</span> <span class="o">=</span> <span class="n">indices</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="n">all_chosen_indices</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cells_x</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cells_y</span><span class="p">):</span>
            <span class="n">cell_probs</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">start_probabilities</span><span class="p">[(</span><span class="n">i</span><span class="o">*</span><span class="n">cell_width</span><span class="p">):(</span><span class="n">i</span><span class="o">*</span><span class="n">cell_width</span><span class="p">)</span><span class="o">+</span><span class="n">cell_width</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">cell_width</span><span class="p">):(</span><span class="n">j</span><span class="o">*</span><span class="n">cell_width</span><span class="p">)</span><span class="o">+</span><span class="n">cell_width</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">cell_probs</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">cell_indices</span> <span class="o">=</span> <span class="n">indices_grid</span><span class="p">[(</span><span class="n">i</span><span class="o">*</span><span class="n">cell_width</span><span class="p">):(</span><span class="n">i</span><span class="o">*</span><span class="n">cell_width</span><span class="p">)</span><span class="o">+</span><span class="n">cell_width</span><span class="p">,</span> <span class="p">(</span><span class="n">j</span><span class="o">*</span><span class="n">cell_width</span><span class="p">):(</span><span class="n">j</span><span class="o">*</span><span class="n">cell_width</span><span class="p">)</span><span class="o">+</span><span class="n">cell_width</span><span class="p">]</span>
                <span class="n">cell_probs</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cell_probs</span><span class="p">)</span>

                <span class="n">chosen_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">cell_indices</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">size</span><span class="o">=</span><span class="n">n_by_cell</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">cell_probs</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="n">all_chosen_indices</span> <span class="o">+=</span> <span class="n">chosen_indices</span>

    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_chosen_indices</span><span class="p">)</span>
    <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unravel_index</span><span class="p">(</span><span class="n">all_chosen_indices</span><span class="p">,</span> <span class="n">environment</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="k">return</span> <span class="n">run_test</span><span class="p">(</span>
        <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">start_points</span><span class="o">=</span><span class="n">start_points</span><span class="p">,</span>
        <span class="n">environment</span><span class="o">=</span><span class="n">environment</span> <span class="k">if</span> <span class="n">environment_provided</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">time_shift</span><span class="o">=</span><span class="n">time_shift</span><span class="p">,</span>
        <span class="n">time_loop</span><span class="o">=</span><span class="n">time_loop</span><span class="p">,</span>
        <span class="n">horizon</span><span class="o">=</span><span class="n">horizon</span><span class="p">,</span>
        <span class="n">reward_discount</span><span class="o">=</span><span class="n">reward_discount</span><span class="p">,</span>
        <span class="n">print_progress</span><span class="o">=</span><span class="n">print_progress</span><span class="p">,</span>
        <span class="n">print_stats</span><span class="o">=</span><span class="n">print_stats</span><span class="p">,</span>
        <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="olfactory_navigation.test_setups.test_scale_robustness" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">test_scale_robustness</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">step_percentage</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">min_percentage</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">max_percentage</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">multipliers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">print_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_analysis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function to test the robustness of an agent in a environment where the scale of the environment's shape is altered by some percentage.</p>
<p>A list of multipliers will be constructed from the min_percentage to 100% and up to max_percentage values with between each percentage step_percentage values.
These percentage multipliers will be applied both in the x and y direction but cropped to the largest allowed multiplier along each axis.</p>
<p>This complete test consists in running from all possible start positions of the original environment.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>agent</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agent.Agent" href="../agent/#olfactory_navigation.agent.Agent">Agent</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The agent to run the shape robustness test on.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>step_percentage</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Starting at 100%, how much of a percentage step to do to reach the min and max percentages.</p>
            </div>
          </td>
          <td>
                <code>20</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>min_percentage</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The minimum percentage of deformation to apply on the environment's odor plume.</p>
            </div>
          </td>
          <td>
                <code>20</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>max_percentage</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum percentage of deformation to apply on the environment's odor plume.
If this value is larger than the maximum shape allowed by the margins, the largest allowed percentage will be used.</p>
            </div>
          </td>
          <td>
                <code>200</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>multipliers</code></td>
          <td>
                <code>list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If provided, the step_percentage, min_percentage and max_percentage parameters will be ignored.
A list of percentages of deformations to use to deforme the environment's odor plume.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>use_gpu</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use the GPU to speed up the tests.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>print_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to display a progress bar of how many test have been performed so far.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>print_stats</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to display statistics at the end of each test.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>save</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to save the results of each test to a save_folder.
Each test's result will be under the name 'test_env_mult-<multiplier>.csv'</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>save_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to which the test results are saved.
If not provided, it will automatically create a new folder './results/<timestamp><em>scale_robustness_test</em><environment_name>/'</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>save_analysis</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to save the analysis of the histories.
It will be saved under a file named '_analysis.csv' in the save_folder.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>all_histories</code></td>          <td>
                <code>list[<a class="autorefs autorefs-internal" title="olfactory_navigation.simulation.SimulationHistory" href="../simulation/#olfactory_navigation.simulation.SimulationHistory">SimulationHistory</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of SimulationHistory instances.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\test_setups.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">test_scale_robustness</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">Agent</span><span class="p">,</span>
                          <span class="n">step_percentage</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                          <span class="n">min_percentage</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                          <span class="n">max_percentage</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
                          <span class="n">multipliers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">use_gpu</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="n">print_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                          <span class="n">print_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                          <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                          <span class="n">save_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">save_analysis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
                          <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">SimulationHistory</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to test the robustness of an agent in a environment where the scale of the environment&#39;s shape is altered by some percentage.</span>

<span class="sd">    A list of multipliers will be constructed from the min_percentage to 100% and up to max_percentage values with between each percentage step_percentage values.</span>
<span class="sd">    These percentage multipliers will be applied both in the x and y direction but cropped to the largest allowed multiplier along each axis.</span>

<span class="sd">    This complete test consists in running from all possible start positions of the original environment.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    agent : Agent</span>
<span class="sd">        The agent to run the shape robustness test on.</span>
<span class="sd">    step_percentage : int, default=20</span>
<span class="sd">        Starting at 100%, how much of a percentage step to do to reach the min and max percentages.</span>
<span class="sd">    min_percentage : int, default=20</span>
<span class="sd">        The minimum percentage of deformation to apply on the environment&#39;s odor plume.</span>
<span class="sd">    max_percentage : int, default=200</span>
<span class="sd">        The maximum percentage of deformation to apply on the environment&#39;s odor plume.</span>
<span class="sd">        If this value is larger than the maximum shape allowed by the margins, the largest allowed percentage will be used.</span>
<span class="sd">    multipliers : list[int], optional</span>
<span class="sd">        If provided, the step_percentage, min_percentage and max_percentage parameters will be ignored.</span>
<span class="sd">        A list of percentages of deformations to use to deforme the environment&#39;s odor plume.</span>
<span class="sd">    use_gpu : bool, default=False</span>
<span class="sd">        Whether to use the GPU to speed up the tests.</span>
<span class="sd">    print_progress : bool, default=True</span>
<span class="sd">        Whether to display a progress bar of how many test have been performed so far.</span>
<span class="sd">    print_stats : bool, default=True</span>
<span class="sd">        Whether to display statistics at the end of each test.</span>
<span class="sd">    save : bool, default=True</span>
<span class="sd">        Whether to save the results of each test to a save_folder.</span>
<span class="sd">        Each test&#39;s result will be under the name &#39;test_env_mult-&lt;multiplier&gt;.csv&#39;</span>
<span class="sd">    save_folder : str, optional</span>
<span class="sd">        The path to which the test results are saved.</span>
<span class="sd">        If not provided, it will automatically create a new folder &#39;./results/&lt;timestamp&gt;_scale_robustness_test_&lt;environment_name&gt;/&#39;</span>
<span class="sd">    save_analysis : bool, default=True</span>
<span class="sd">        Whether to save the analysis of the histories.</span>
<span class="sd">        It will be saved under a file named &#39;_analysis.csv&#39; in the save_folder.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    all_histories : list[SimulationHistory]</span>
<span class="sd">        A list of SimulationHistory instances.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Gather environment</span>
    <span class="n">environment</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">environment</span>

    <span class="c1"># Gathering starting points</span>
    <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">start_probabilities</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">start_points</span><span class="p">)</span>

    <span class="c1"># Generating multipliers</span>
    <span class="k">if</span> <span class="n">multipliers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="n">low_max_mult</span> <span class="o">=</span> <span class="p">((</span><span class="n">environment</span><span class="o">.</span><span class="n">margins</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">environment</span><span class="o">.</span><span class="n">data_source_position</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">high_max_mult</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">margins</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">data_shape</span> <span class="o">-</span> <span class="n">environment</span><span class="o">.</span><span class="n">data_source_position</span><span class="p">)))</span>
            <span class="n">max_mult</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">low_max_mult</span><span class="p">,</span> <span class="n">high_max_mult</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">multipliers</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">perc_mult</span><span class="p">)</span> <span class="k">for</span> <span class="n">perc_mult</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">min_percentage</span><span class="p">)</span><span class="o">+</span><span class="n">step_percentage</span><span class="p">,</span> <span class="n">step_percentage</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">+</span> <span class="p">[</span><span class="n">perc_mult</span> <span class="k">for</span> <span class="n">perc_mult</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_percentage</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">max_mult</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span> <span class="n">step_percentage</span><span class="p">)]</span>
    <span class="n">multipliers</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="c1"># Save Folder name and creation</span>
    <span class="k">if</span> <span class="n">save</span> <span class="ow">or</span> <span class="n">save_analysis</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">save_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">save_folder</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;./results/</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">_scale_robustness_test_&#39;</span> <span class="o">+</span> <span class="n">environment</span><span class="o">.</span><span class="n">name</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">save_folder</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The results will be saved to: </span><span class="si">{</span><span class="n">save_folder</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">all_histories</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">mult</span> <span class="ow">in</span> <span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">multipliers</span><span class="p">)</span> <span class="k">if</span> <span class="n">print_progress</span> <span class="k">else</span> <span class="n">multipliers</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Testing on environment with scale modifier </span><span class="si">{</span><span class="n">mult</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

        <span class="c1"># Modifying environment and agent</span>
        <span class="n">modified_environment</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">modify_scale</span><span class="p">(</span><span class="n">scale_factor</span><span class="o">=</span><span class="n">mult</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">modified_agent</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">modify_environment</span><span class="p">(</span><span class="n">modified_environment</span><span class="p">)</span>

        <span class="c1"># Running test</span>
        <span class="n">hist</span> <span class="o">=</span> <span class="n">run_all_starts_test</span><span class="p">(</span>
            <span class="n">agent</span><span class="o">=</span><span class="n">modified_agent</span><span class="p">,</span>
            <span class="n">print_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">print_stats</span><span class="o">=</span><span class="n">print_stats</span><span class="p">,</span>
            <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">)</span>

        <span class="n">all_histories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>

        <span class="c1"># Saving history</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;test_env_mult-</span><span class="si">{</span><span class="n">mult</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">hist</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                      <span class="n">folder</span><span class="o">=</span><span class="n">save_folder</span><span class="p">,</span>
                      <span class="n">save_analysis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># Analysis saving</span>
    <span class="k">if</span> <span class="n">save</span> <span class="ow">and</span> <span class="n">save_analysis</span><span class="p">:</span>
        <span class="n">analysis_df</span> <span class="o">=</span> <span class="n">analyse_scale_robustness</span><span class="p">(</span><span class="n">all_histories</span><span class="o">=</span><span class="n">all_histories</span><span class="p">,</span> <span class="n">multipliers</span><span class="o">=</span><span class="n">multipliers</span><span class="p">)</span>
        <span class="n">analysis_file_name</span> <span class="o">=</span> <span class="s1">&#39;_analysis.csv&#39;</span>
        <span class="n">analysis_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_folder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">analysis_file_name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Scale robustness analysis saved to: </span><span class="si">{</span><span class="n">save_folder</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">analysis_file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">all_histories</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="olfactory_navigation.test_setups.test_shape_robustness" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">test_shape_robustness</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="n">step_percentage</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">min_percentage</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">max_percentage</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">multipliers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_gpu</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">print_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">print_stats</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_analysis</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


  <div class="doc doc-contents ">
  
      <p>Function to test the robustness of an agent in a environment where the odor plume's shape is altered by some percentage.</p>
<p>A list of multipliers will be constructed from the min_percentage to 100% and up to max_percentage values with between each percentage step_percentage values.
These percentage multipliers will be applied both in the x and y direction but cropped to the largest allowed multiplier along each axis.</p>
<p>For each multiplier pair, a completed test will be run. This complete test consists in running from all possible start positions of the original environment.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>agent</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agent.Agent" href="../agent/#olfactory_navigation.agent.Agent">Agent</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The agent to run the shape robustness test on.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>step_percentage</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Starting at 100%, how much of a percentage step to do to reach the min and max percentages.</p>
            </div>
          </td>
          <td>
                <code>20</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>min_percentage</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The minimum percentage of deformation to apply on the environment's odor plume.</p>
            </div>
          </td>
          <td>
                <code>20</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>max_percentage</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum percentage of deformation to apply on the environment's odor plume.
If this value is larger than the maximum shape allowed by the margins, the largest allowed percentage will be used.</p>
            </div>
          </td>
          <td>
                <code>200</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>multipliers</code></td>
          <td>
                <code>list[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If provided, the step_percentage, min_percentage and max_percentage parameters will be ignored.
A list of percentages of deformations to use to deforme the environment's odor plume.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>use_gpu</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to use the GPU to speed up the tests.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>print_progress</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to display a progress bar of how many test have been performed so far.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>print_stats</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to display statistics at the end of each test.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>save</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to save the results of each test to a save_folder.
Each test's result will be under the name 'test_env_y-<y_multiplier>_x-<x_multiplier>.csv'</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>save_folder</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path to which the test results are saved.
If not provided, it will automatically create a new folder './results/<timestamp><em>shape_robustness_test</em><environment_name>/'</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>save_analysis</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to save the analysis of the histories.
It will be saved under a file named '_analysis.csv' in the save_folder.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>all_histories</code></td>          <td>
                <code>list[<a class="autorefs autorefs-internal" title="olfactory_navigation.simulation.SimulationHistory" href="../simulation/#olfactory_navigation.simulation.SimulationHistory">SimulationHistory</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of SimulationHistory instances.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\test_setups.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">test_shape_robustness</span><span class="p">(</span><span class="n">agent</span><span class="p">:</span> <span class="n">Agent</span><span class="p">,</span>
                          <span class="n">step_percentage</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                          <span class="n">min_percentage</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
                          <span class="n">max_percentage</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
                          <span class="n">multipliers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">use_gpu</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                          <span class="n">print_progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                          <span class="n">print_stats</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                          <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                          <span class="n">save_folder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">save_analysis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
                          <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">SimulationHistory</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to test the robustness of an agent in a environment where the odor plume&#39;s shape is altered by some percentage.</span>

<span class="sd">    A list of multipliers will be constructed from the min_percentage to 100% and up to max_percentage values with between each percentage step_percentage values.</span>
<span class="sd">    These percentage multipliers will be applied both in the x and y direction but cropped to the largest allowed multiplier along each axis.</span>

<span class="sd">    For each multiplier pair, a completed test will be run. This complete test consists in running from all possible start positions of the original environment.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    agent : Agent</span>
<span class="sd">        The agent to run the shape robustness test on.</span>
<span class="sd">    step_percentage : int, default=20</span>
<span class="sd">        Starting at 100%, how much of a percentage step to do to reach the min and max percentages.</span>
<span class="sd">    min_percentage : int, default=20</span>
<span class="sd">        The minimum percentage of deformation to apply on the environment&#39;s odor plume.</span>
<span class="sd">    max_percentage : int, default=200</span>
<span class="sd">        The maximum percentage of deformation to apply on the environment&#39;s odor plume.</span>
<span class="sd">        If this value is larger than the maximum shape allowed by the margins, the largest allowed percentage will be used.</span>
<span class="sd">    multipliers : list[int], optional</span>
<span class="sd">        If provided, the step_percentage, min_percentage and max_percentage parameters will be ignored.</span>
<span class="sd">        A list of percentages of deformations to use to deforme the environment&#39;s odor plume.</span>
<span class="sd">    use_gpu : bool, default=False</span>
<span class="sd">        Whether to use the GPU to speed up the tests.</span>
<span class="sd">    print_progress : bool, default=True</span>
<span class="sd">        Whether to display a progress bar of how many test have been performed so far.</span>
<span class="sd">    print_stats : bool, default=True</span>
<span class="sd">        Whether to display statistics at the end of each test.</span>
<span class="sd">    save : bool, default=True</span>
<span class="sd">        Whether to save the results of each test to a save_folder.</span>
<span class="sd">        Each test&#39;s result will be under the name &#39;test_env_y-&lt;y_multiplier&gt;_x-&lt;x_multiplier&gt;.csv&#39;</span>
<span class="sd">    save_folder : str, optional</span>
<span class="sd">        The path to which the test results are saved.</span>
<span class="sd">        If not provided, it will automatically create a new folder &#39;./results/&lt;timestamp&gt;_shape_robustness_test_&lt;environment_name&gt;/&#39;</span>
<span class="sd">    save_analysis : bool, default=True</span>
<span class="sd">        Whether to save the analysis of the histories.</span>
<span class="sd">        It will be saved under a file named &#39;_analysis.csv&#39; in the save_folder.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    all_histories : list[SimulationHistory]</span>
<span class="sd">        A list of SimulationHistory instances.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Gather environment</span>
    <span class="n">environment</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">environment</span>

    <span class="c1"># Gathering starting points</span>
    <span class="n">start_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">start_probabilities</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">start_points</span><span class="p">)</span>

    <span class="c1"># Generating multipliers</span>
    <span class="k">if</span> <span class="n">multipliers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="n">low_max_mult</span> <span class="o">=</span> <span class="p">((</span><span class="n">environment</span><span class="o">.</span><span class="n">margins</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">environment</span><span class="o">.</span><span class="n">data_source_position</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">high_max_mult</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">margins</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">environment</span><span class="o">.</span><span class="n">data_shape</span> <span class="o">-</span> <span class="n">environment</span><span class="o">.</span><span class="n">data_source_position</span><span class="p">)))</span>
            <span class="n">max_mult</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">low_max_mult</span><span class="p">,</span> <span class="n">high_max_mult</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">multipliers</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">100</span> <span class="o">-</span> <span class="n">perc_mult</span><span class="p">)</span> <span class="k">for</span> <span class="n">perc_mult</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">min_percentage</span><span class="p">)</span><span class="o">+</span><span class="n">step_percentage</span><span class="p">,</span> <span class="n">step_percentage</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]]</span> <span class="o">+</span> <span class="p">[</span><span class="n">perc_mult</span> <span class="k">for</span> <span class="n">perc_mult</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">max_percentage</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">max_mult</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">)),</span> <span class="n">step_percentage</span><span class="p">)]</span>
    <span class="n">multipliers</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="c1"># Generating all combinations of multipliers</span>
    <span class="n">mult_combinations</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">multipliers</span><span class="p">,</span> <span class="n">multipliers</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">mult_combinations</span> <span class="o">/=</span> <span class="mi">100</span>
    <span class="n">mult_combinations</span> <span class="o">=</span> <span class="n">mult_combinations</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">mult_combinations</span> <span class="o">&lt;</span> <span class="n">max_mult</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="p">:]</span>

    <span class="c1"># Save Folder name and creation</span>
    <span class="k">if</span> <span class="n">save</span> <span class="ow">or</span> <span class="n">save_analysis</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">save_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">save_folder</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;./results/</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">_shape_robustness_test_&#39;</span> <span class="o">+</span> <span class="n">environment</span><span class="o">.</span><span class="n">name</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">save_folder</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The results will be saved to: </span><span class="si">{</span><span class="n">save_folder</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">all_histories</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">mults</span> <span class="ow">in</span> <span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">mult_combinations</span><span class="p">)</span> <span class="k">if</span> <span class="n">print_progress</span> <span class="k">else</span> <span class="n">mult_combinations</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Testing on environment with height </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">mults</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">% and width </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">mults</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>

        <span class="c1"># Modifying environment</span>
        <span class="n">modified_environment</span> <span class="o">=</span> <span class="n">environment</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="n">multiplier</span><span class="o">=</span><span class="n">mults</span><span class="p">)</span>

        <span class="c1"># Running test</span>
        <span class="n">hist</span> <span class="o">=</span> <span class="n">run_test</span><span class="p">(</span>
            <span class="n">agent</span><span class="o">=</span><span class="n">agent</span><span class="p">,</span>
            <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
            <span class="n">start_points</span><span class="o">=</span><span class="n">start_points</span><span class="p">,</span>
            <span class="n">environment</span><span class="o">=</span><span class="n">modified_environment</span><span class="p">,</span>
            <span class="n">print_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">print_stats</span><span class="o">=</span><span class="n">print_stats</span><span class="p">,</span>
            <span class="n">use_gpu</span><span class="o">=</span><span class="n">use_gpu</span><span class="p">)</span>

        <span class="n">all_histories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>

        <span class="c1"># Saving history</span>
        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;test_env_y-</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">mults</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">_x-</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">mults</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">hist</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span>
                      <span class="n">folder</span><span class="o">=</span><span class="n">save_folder</span><span class="p">,</span>
                      <span class="n">save_analysis</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">()</span>

    <span class="c1"># Analysis saving</span>
    <span class="k">if</span> <span class="n">save</span> <span class="ow">and</span> <span class="n">save_analysis</span><span class="p">:</span>
        <span class="n">analysis_df</span> <span class="o">=</span> <span class="n">analyse_shape_robustness</span><span class="p">(</span><span class="n">all_histories</span><span class="o">=</span><span class="n">all_histories</span><span class="p">,</span> <span class="n">multipliers</span><span class="o">=</span><span class="p">(</span><span class="n">mult_combinations</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>
        <span class="n">analysis_file_name</span> <span class="o">=</span> <span class="s1">&#39;_analysis.csv&#39;</span>
        <span class="n">analysis_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">save_folder</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">analysis_file_name</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Shape robustness analysis saved to: </span><span class="si">{</span><span class="n">save_folder</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">analysis_file_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">all_histories</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../simulation/" class="md-footer__link md-footer__link--prev" aria-label="Previous: simulation">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                simulation
              </div>
            </div>
          </a>
        
        
          
          <a href="../visualization/" class="md-footer__link md-footer__link--next" aria-label="Next: visualization">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                visualization
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "navigation.expand", "navigation.path", "navigation.top", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5cfa9459.min.js"></script>
      
    
  </body>
</html>