
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../belief_value_mapping/">
      
      
      <link rel="icon" href="../../../../img/squid_drawing.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.22">
    
    
      
        <title>belief - Olfactory Navigation Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.732c4fb1.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#olfactory_navigation.agents.model_based_util.belief" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Olfactory Navigation Documentation" class="md-header__button md-logo" aria-label="Olfactory Navigation Documentation" data-md-component="logo">
      
  <img src="../../../../img/squid_drawing.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Olfactory Navigation Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              belief
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/PimLb/olfactory-navigation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  Code Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../agent_creation/" class="md-tabs__link">
          
  
  Tutorials

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Olfactory Navigation Documentation" class="md-nav__button md-logo" aria-label="Olfactory Navigation Documentation" data-md-component="logo">
      
  <img src="../../../../img/squid_drawing.png" alt="logo">

    </a>
    Olfactory Navigation Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PimLb/olfactory-navigation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Code Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    olfactory_navigation
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            olfactory_navigation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    agents
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_2">
            <span class="md-nav__icon md-icon"></span>
            agents
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../fsvi_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fsvi_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hsvi_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    hsvi_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../infotaxis_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    infotaxis_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    model_based_util
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1_2_4" id="__nav_2_1_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_2_1_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_2_4">
            <span class="md-nav__icon md-icon"></span>
            model_based_util
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    belief
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    belief
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief" class="md-nav__link">
    <span class="md-ellipsis">
      belief
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief" class="md-nav__link">
    <span class="md-ellipsis">
      Belief
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Belief">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.bytes_repr" class="md-nav__link">
    <span class="md-ellipsis">
      bytes_repr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.entropy" class="md-nav__link">
    <span class="md-ellipsis">
      entropy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.values" class="md-nav__link">
    <span class="md-ellipsis">
      values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.__eq__" class="md-nav__link">
    <span class="md-ellipsis">
      __eq__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.generate_successors" class="md-nav__link">
    <span class="md-ellipsis">
      generate_successors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.random_state" class="md-nav__link">
    <span class="md-ellipsis">
      random_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.update" class="md-nav__link">
    <span class="md-ellipsis">
      update
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet" class="md-nav__link">
    <span class="md-ellipsis">
      BeliefSet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BeliefSet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.belief_array" class="md-nav__link">
    <span class="md-ellipsis">
      belief_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.belief_list" class="md-nav__link">
    <span class="md-ellipsis">
      belief_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.entropies" class="md-nav__link">
    <span class="md-ellipsis">
      entropies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.unique_belief_dict" class="md-nav__link">
    <span class="md-ellipsis">
      unique_belief_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.generate_all_successors" class="md-nav__link">
    <span class="md-ellipsis">
      generate_all_successors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.to_cpu" class="md-nav__link">
    <span class="md-ellipsis">
      to_cpu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.to_gpu" class="md-nav__link">
    <span class="md-ellipsis">
      to_gpu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.union" class="md-nav__link">
    <span class="md-ellipsis">
      union
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.update" class="md-nav__link">
    <span class="md-ellipsis">
      update
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../belief_value_mapping/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    belief_value_mapping
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mdp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pomdp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pomdp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../value_function/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    value_function
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vi_solver/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vi_solver
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pbvi_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pbvi_ger_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_ger_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pbvi_ra_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_ra_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pbvi_ssea_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_ssea_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pbvi_ssga_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_ssga_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pbvi_ssra_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbvi_ssra_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../perseus_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    perseus_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../q_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    q_agent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../qmdp_agent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    qmdp_agent
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../simulation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    simulation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../test_setups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    test_setups
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../agent_creation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to Create an Agent?
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief" class="md-nav__link">
    <span class="md-ellipsis">
      belief
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief" class="md-nav__link">
    <span class="md-ellipsis">
      Belief
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Belief">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.bytes_repr" class="md-nav__link">
    <span class="md-ellipsis">
      bytes_repr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.entropy" class="md-nav__link">
    <span class="md-ellipsis">
      entropy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.values" class="md-nav__link">
    <span class="md-ellipsis">
      values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.__eq__" class="md-nav__link">
    <span class="md-ellipsis">
      __eq__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.generate_successors" class="md-nav__link">
    <span class="md-ellipsis">
      generate_successors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.random_state" class="md-nav__link">
    <span class="md-ellipsis">
      random_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.Belief.update" class="md-nav__link">
    <span class="md-ellipsis">
      update
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet" class="md-nav__link">
    <span class="md-ellipsis">
      BeliefSet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BeliefSet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.belief_array" class="md-nav__link">
    <span class="md-ellipsis">
      belief_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.belief_list" class="md-nav__link">
    <span class="md-ellipsis">
      belief_list
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.entropies" class="md-nav__link">
    <span class="md-ellipsis">
      entropies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.unique_belief_dict" class="md-nav__link">
    <span class="md-ellipsis">
      unique_belief_dict
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.generate_all_successors" class="md-nav__link">
    <span class="md-ellipsis">
      generate_all_successors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.to_cpu" class="md-nav__link">
    <span class="md-ellipsis">
      to_cpu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.to_gpu" class="md-nav__link">
    <span class="md-ellipsis">
      to_gpu
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.union" class="md-nav__link">
    <span class="md-ellipsis">
      union
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.update" class="md-nav__link">
    <span class="md-ellipsis">
      update
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>belief</h1>

<div class="doc doc-object doc-module">



<a id="olfactory_navigation.agents.model_based_util.belief"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="olfactory_navigation.agents.model_based_util.belief.Belief" class="doc doc-heading">
          <code>Belief</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>A class representing a belief in the space of a given model. It is the belief to be in any combination of states:
eg:
    - In a 2 state POMDP: a belief of (0.5, 0.5) represent the complete ignorance of which state we are in. Where a (1.0, 0.0) belief is the certainty to be in state 0.</p>
<p>The belief update function has been implemented based on the belief update define in the paper of J. Pineau, G. Gordon, and S. Thrun, 'Point-based approximations for fast POMDP solving'</p>
<p>...</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>model</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.pomdp.Model" href="../pomdp/#olfactory_navigation.agents.model_based_util.pomdp.Model">Model</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The model on which the belief applies on.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>values</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A vector of the probabilities to be in each state of the model. The sum of the probabilities must sum to 1.
If not specified, it will be set as the start probabilities of the model.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="olfactory_navigation.agents.model_based_util.belief.Belief.model">model</span></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.pomdp.Model" href="../pomdp/#olfactory_navigation.agents.model_based_util.pomdp.Model">Model</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.Belief.values" href="#olfactory_navigation.agents.model_based_util.belief.Belief.values">values</a></code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.Belief.bytes_repr" href="#olfactory_navigation.agents.model_based_util.belief.Belief.bytes_repr">bytes_repr</a></code></td>
          <td>
                <code>bytes</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A representation in bytes of the value of the belief</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Belief</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A class representing a belief in the space of a given model. It is the belief to be in any combination of states:</span>
<span class="sd">    eg:</span>
<span class="sd">        - In a 2 state POMDP: a belief of (0.5, 0.5) represent the complete ignorance of which state we are in. Where a (1.0, 0.0) belief is the certainty to be in state 0.</span>

<span class="sd">    The belief update function has been implemented based on the belief update define in the paper of J. Pineau, G. Gordon, and S. Thrun, &#39;Point-based approximations for fast POMDP solving&#39;</span>

<span class="sd">    ...</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model : pomdp.Model</span>
<span class="sd">        The model on which the belief applies on.</span>
<span class="sd">    values : np.ndarray, optional</span>
<span class="sd">        A vector of the probabilities to be in each state of the model. The sum of the probabilities must sum to 1.</span>
<span class="sd">        If not specified, it will be set as the start probabilities of the model.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    model : pomdp.Model</span>
<span class="sd">    values : np.ndarray</span>
<span class="sd">    bytes_repr : bytes</span>
<span class="sd">        A representation in bytes of the value of the belief</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span><span class="n">Model</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">model</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

        <span class="k">if</span> <span class="n">values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">state_count</span><span class="p">,</span> <span class="s2">&quot;Belief must contain be of dimension |S|&quot;</span>

            <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">gpu_support</span> <span class="k">else</span> <span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

            <span class="n">prob_sum</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
            <span class="n">rounded_sum</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">prob_sum</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">rounded_sum</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;States probabilities in belief must sum to 1 (found: </span><span class="si">{</span><span class="n">prob_sum</span><span class="si">}</span><span class="s2">; rounded </span><span class="si">{</span><span class="n">rounded_sum</span><span class="si">}</span><span class="s2">)&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">start_probabilities</span>


    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

        <span class="n">instance</span><span class="o">.</span><span class="n">_bytes_repr</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">_successors</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="n">instance</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bytes_repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        A representation as bytes of a belief.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bytes_repr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bytes_repr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bytes_repr</span>


    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        A way to check the equality between two belief points.</span>
<span class="sd">        The byte representation of each belief point is compared.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytes_repr</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">bytes_repr</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        An array of the probability distribution to be in each state.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span>


    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">a</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
               <span class="n">o</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
               <span class="n">throw_error</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
               <span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Belief&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a new belief based on this current belief, the most recent action (a) and the most recent observation (o).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        a : int</span>
<span class="sd">            The most recent action.</span>
<span class="sd">        o : int</span>
<span class="sd">            The most recent observation.</span>
<span class="sd">        throw_error : bool, default=True</span>
<span class="sd">            Whether the creation of an impossible belief (sum of probabilities of 0.0) will throw an error or not.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        new_belief : Belief</span>
<span class="sd">            An updated belief</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">gpu_support</span> <span class="k">else</span> <span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>

        <span class="c1"># Check if successor exists</span>
        <span class="n">succ_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">o</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">succ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_successors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">succ_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">succ</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">succ</span>

        <span class="c1"># Computing new probabilities</span>
        <span class="n">reachable_state_probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">reachable_transitional_observation_table</span><span class="p">[:,</span><span class="n">a</span><span class="p">,</span><span class="n">o</span><span class="p">,:]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">new_state_probabilities</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">reachable_states</span><span class="p">[:,</span><span class="n">a</span><span class="p">,:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">weights</span><span class="o">=</span><span class="n">reachable_state_probabilities</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">minlength</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span><span class="p">)</span>

        <span class="c1"># Normalization</span>
        <span class="n">probability_sum</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">new_state_probabilities</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">probability_sum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">throw_error</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Impossible belief: the sum of probabilities is 0...&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_state_probabilities</span> <span class="o">/=</span> <span class="n">probability_sum</span>

        <span class="c1"># Generation of new belief from new state probabilities</span>
        <span class="n">new_belief</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
        <span class="n">new_belief</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span>
        <span class="n">new_belief</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">new_state_probabilities</span>

        <span class="c1"># Remember generated successor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_successors</span><span class="p">[</span><span class="n">succ_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_belief</span>

        <span class="k">return</span> <span class="n">new_belief</span>


    <span class="k">def</span> <span class="nf">generate_successors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s1">&#39;Belief&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to generate a set of belief that can be reached for each actions and observations available in the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        successor_beliefs : list[Belief]</span>
<span class="sd">            The successor beliefs.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">successor_beliefs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">observations</span><span class="p">:</span>
                <span class="n">b_ao</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">o</span><span class="p">)</span>
                <span class="n">successor_beliefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_ao</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">successor_beliefs</span>


    <span class="k">def</span> <span class="nf">random_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a random state of the model weighted by the belief probabily.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        rand_s : int</span>
<span class="sd">            A random state.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">gpu_support</span> <span class="k">else</span> <span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>

        <span class="n">rand_s</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">rand_s</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entropy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The entropy of the belief point</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">gpu_support</span> <span class="k">else</span> <span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">entropy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span> <span class="k">if</span> <span class="n">xp</span> <span class="o">==</span> <span class="n">np</span> <span class="k">else</span> <span class="n">cupy_entropy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to plot a heatmap of the belief distribution if the belief is of a grid model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : int, default=5</span>
<span class="sd">            The scale of the plot.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Plot setup</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">size</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span><span class="n">size</span><span class="p">))</span>

        <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cpu_model</span>

        <span class="c1"># Ticks</span>
        <span class="n">dimensions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">state_grid</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">x_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)))</span>
        <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)))</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">)</span>

        <span class="c1"># Title</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Belief (probability distribution over states)&#39;</span><span class="p">)</span>

        <span class="c1"># Actual plot</span>
        <span class="n">belief_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">gpu_support</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="p">)</span> <span class="k">else</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
        <span class="n">grid_values</span> <span class="o">=</span> <span class="n">belief_values</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">state_grid</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">grid_values</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="olfactory_navigation.agents.model_based_util.belief.Belief.bytes_repr" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">bytes_repr</span><span class="p">:</span> <span class="nb">bytes</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>A representation as bytes of a belief.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="olfactory_navigation.agents.model_based_util.belief.Belief.entropy" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">entropy</span><span class="p">:</span> <span class="nb">float</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>The entropy of the belief point</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="olfactory_navigation.agents.model_based_util.belief.Belief.values" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>An array of the probability distribution to be in each state.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="olfactory_navigation.agents.model_based_util.belief.Belief.__eq__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>A way to check the equality between two belief points.
The byte representation of each belief point is compared.</p>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A way to check the equality between two belief points.</span>
<span class="sd">    The byte representation of each belief point is compared.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bytes_repr</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">bytes_repr</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="olfactory_navigation.agents.model_based_util.belief.Belief.generate_successors" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_successors</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Function to generate a set of belief that can be reached for each actions and observations available in the model.</p>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>successor_beliefs</code></td>          <td>
                <code>list[<a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.Belief" href="#olfactory_navigation.agents.model_based_util.belief.Belief">Belief</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The successor beliefs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_successors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="s1">&#39;Belief&#39;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to generate a set of belief that can be reached for each actions and observations available in the model.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    successor_beliefs : list[Belief]</span>
<span class="sd">        The successor beliefs.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">successor_beliefs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">actions</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">observations</span><span class="p">:</span>
            <span class="n">b_ao</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">o</span><span class="p">)</span>
            <span class="n">successor_beliefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b_ao</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">successor_beliefs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="olfactory_navigation.agents.model_based_util.belief.Belief.plot" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Function to plot a heatmap of the belief distribution if the belief is of a grid model.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The scale of the plot.</p>
            </div>
          </td>
          <td>
                <code>5</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to plot a heatmap of the belief distribution if the belief is of a grid model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    size : int, default=5</span>
<span class="sd">        The scale of the plot.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Plot setup</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="n">size</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span><span class="n">size</span><span class="p">))</span>

    <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cpu_model</span>

    <span class="c1"># Ticks</span>
    <span class="n">dimensions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">state_grid</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">x_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)))</span>
    <span class="n">y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">else</span> <span class="nb">int</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x_ticks</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">y_ticks</span><span class="p">)</span>

    <span class="c1"># Title</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Belief (probability distribution over states)&#39;</span><span class="p">)</span>

    <span class="c1"># Actual plot</span>
    <span class="n">belief_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_values</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">gpu_support</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="p">)</span> <span class="k">else</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>
    <span class="n">grid_values</span> <span class="o">=</span> <span class="n">belief_values</span><span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">state_grid</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">grid_values</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="olfactory_navigation.agents.model_based_util.belief.Belief.random_state" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">random_state</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns a random state of the model weighted by the belief probabily.</p>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>rand_s</code></td>          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A random state.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">random_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns a random state of the model weighted by the belief probabily.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    rand_s : int</span>
<span class="sd">        A random state.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">gpu_support</span> <span class="k">else</span> <span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>

    <span class="n">rand_s</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xp</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">rand_s</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="olfactory_navigation.agents.model_based_util.belief.Belief.update" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">o</span><span class="p">,</span> <span class="n">throw_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns a new belief based on this current belief, the most recent action (a) and the most recent observation (o).</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>a</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The most recent action.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>o</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The most recent observation.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>throw_error</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the creation of an impossible belief (sum of probabilities of 0.0) will throw an error or not.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>new_belief</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.Belief" href="#olfactory_navigation.agents.model_based_util.belief.Belief">Belief</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An updated belief</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
           <span class="n">a</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
           <span class="n">o</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span>
           <span class="n">throw_error</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
           <span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Belief&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns a new belief based on this current belief, the most recent action (a) and the most recent observation (o).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : int</span>
<span class="sd">        The most recent action.</span>
<span class="sd">    o : int</span>
<span class="sd">        The most recent observation.</span>
<span class="sd">    throw_error : bool, default=True</span>
<span class="sd">        Whether the creation of an impossible belief (sum of probabilities of 0.0) will throw an error or not.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_belief : Belief</span>
<span class="sd">        An updated belief</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">gpu_support</span> <span class="k">else</span> <span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_values</span><span class="p">)</span>

    <span class="c1"># Check if successor exists</span>
    <span class="n">succ_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">o</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">succ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_successors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">succ_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">succ</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">succ</span>

    <span class="c1"># Computing new probabilities</span>
    <span class="n">reachable_state_probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">reachable_transitional_observation_table</span><span class="p">[:,</span><span class="n">a</span><span class="p">,</span><span class="n">o</span><span class="p">,:]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
    <span class="n">new_state_probabilities</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">reachable_states</span><span class="p">[:,</span><span class="n">a</span><span class="p">,:]</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">weights</span><span class="o">=</span><span class="n">reachable_state_probabilities</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">minlength</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span><span class="p">)</span>

    <span class="c1"># Normalization</span>
    <span class="n">probability_sum</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">new_state_probabilities</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">probability_sum</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">throw_error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Impossible belief: the sum of probabilities is 0...&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_state_probabilities</span> <span class="o">/=</span> <span class="n">probability_sum</span>

    <span class="c1"># Generation of new belief from new state probabilities</span>
    <span class="n">new_belief</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
    <span class="n">new_belief</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span>
    <span class="n">new_belief</span><span class="o">.</span><span class="n">_values</span> <span class="o">=</span> <span class="n">new_state_probabilities</span>

    <span class="c1"># Remember generated successor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_successors</span><span class="p">[</span><span class="n">succ_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_belief</span>

    <span class="k">return</span> <span class="n">new_belief</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="olfactory_navigation.agents.model_based_util.belief.BeliefSet" class="doc doc-heading">
          <code>BeliefSet</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Class to represent a set of beliefs with regard to a POMDP model.
It has the purpose to store the beliefs in a numpy array format and be able to conver it to a list of Belief class objects.</p>
<p>...</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>model</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.pomdp.Model" href="../pomdp/#olfactory_navigation.agents.model_based_util.pomdp.Model">Model</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The model on which the beliefs apply.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>beliefs</code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.Belief" href="#olfactory_navigation.agents.model_based_util.belief.Belief">Belief</a>] | <span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The actual set of beliefs.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Attributes:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code><span title="olfactory_navigation.agents.model_based_util.belief.BeliefSet.model">model</span></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.pomdp.Model" href="../pomdp/#olfactory_navigation.agents.model_based_util.pomdp.Model">Model</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.BeliefSet.belief_array" href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.belief_array">belief_array</a></code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A 2D array of shape N x S of N belief vectors.</p>
            </div>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.BeliefSet.belief_list" href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet.belief_list">belief_list</a></code></td>
          <td>
                <code>list[<a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.Belief" href="#olfactory_navigation.agents.model_based_util.belief.Belief">Belief</a>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of N Belief object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BeliefSet</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class to represent a set of beliefs with regard to a POMDP model.</span>
<span class="sd">    It has the purpose to store the beliefs in a numpy array format and be able to conver it to a list of Belief class objects.</span>

<span class="sd">    ...</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model : pomdp.Model</span>
<span class="sd">        The model on which the beliefs apply.</span>
<span class="sd">    beliefs : list[Belief] | np.ndarray</span>
<span class="sd">        The actual set of beliefs.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    model : pomdp.Model</span>
<span class="sd">    belief_array : np.ndarray</span>
<span class="sd">        A 2D array of shape N x S of N belief vectors.</span>
<span class="sd">    belief_list : list[Belief]</span>
<span class="sd">        A list of N Belief object.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span><span class="n">Model</span><span class="p">,</span> <span class="n">beliefs</span><span class="p">:</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Belief</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_uniqueness_dict</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_on_gpu</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">beliefs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">state_count</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">beliefs</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Beliefs in belief list provided dont all have shape (</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span><span class="si">}</span><span class="s2">,)&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span> <span class="o">=</span> <span class="n">beliefs</span>

            <span class="c1"># Check if on gpu and make sure all beliefs are also on the gpu</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">beliefs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">gpu_support</span> <span class="ow">and</span> <span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="n">beliefs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="n">cp</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="n">cp</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">beliefs</span><span class="p">),</span> <span class="s2">&quot;Either all or none of the alpha vectors should be on the GPU, not just some.&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_on_gpu</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">beliefs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">model</span><span class="o">.</span><span class="n">state_count</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Belief array provided doesnt have the right shape (expected (-,</span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span><span class="si">}</span><span class="s2">), received </span><span class="si">{</span><span class="n">beliefs</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">)&quot;</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span> <span class="o">=</span> <span class="n">beliefs</span>

            <span class="c1"># Check if array is on gpu</span>
            <span class="k">if</span> <span class="n">gpu_support</span> <span class="ow">and</span> <span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="n">beliefs</span><span class="p">)</span> <span class="o">==</span> <span class="n">cp</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_on_gpu</span> <span class="o">=</span> <span class="kc">True</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">belief_array</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        A matrix of size N x S containing N belief vectors. If belief set is stored as a list of Belief objects, the matrix of beliefs will be generated from them.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">cp</span> <span class="k">if</span> <span class="p">(</span><span class="n">gpu_support</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_on_gpu</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">b</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">belief_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Belief</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        A list of Belief objects. If the belief set is represented as a matrix of Belief vectors, the list of Belief objects will be generated from it.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Belief</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">belief_vector</span><span class="p">)</span> <span class="k">for</span> <span class="n">belief_vector</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span>


    <span class="k">def</span> <span class="nf">generate_all_successors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BeliefSet&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to generate the successors beliefs of all the beliefs in the belief set.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        all_successors : BeliefSet</span>
<span class="sd">            All successors of all beliefs in the belief set.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">all_successors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">belief</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">belief_list</span><span class="p">:</span>
            <span class="n">all_successors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">belief</span><span class="o">.</span><span class="n">generate_successors</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">all_successors</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
               <span class="n">actions</span><span class="p">:</span><span class="nb">list</span><span class="o">|</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
               <span class="n">observations</span><span class="p">:</span><span class="nb">list</span><span class="o">|</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
               <span class="n">throw_error</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
               <span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BeliefSet&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a new belief based on this current belief, the most recent action (a) and the most recent observation (o).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        actions : list or np.ndarray</span>
<span class="sd">            The most recent played actions.</span>
<span class="sd">        observations : list or np.ndarray</span>
<span class="sd">            The most recent received observations.</span>
<span class="sd">        throw_error : bool, default=True</span>
<span class="sd">            Whether the throw an error when attempting to generate impossible beliefs.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        new_belief_set : BeliefSet</span>
<span class="sd">            An set of updated beliefs.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># GPU support check</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">cp</span> <span class="k">if</span> <span class="p">(</span><span class="n">gpu_support</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_on_gpu</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span>

        <span class="c1"># Ensuring we are dealing we are dealing with ndarrays</span>
        <span class="n">observations</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

        <span class="c1"># Computing reachable probabilities and states</span>
        <span class="n">reachable_probabilities</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">reachable_transitional_observation_table</span><span class="p">[:,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">observations</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">belief_array</span><span class="o">.</span><span class="n">T</span><span class="p">[:,:,</span><span class="kc">None</span><span class="p">])</span>
        <span class="n">reachable_state_per_actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">reachable_states</span><span class="p">[:,</span> <span class="n">actions</span><span class="p">,</span> <span class="p">:]</span>

        <span class="c1"># Computing new probabilities</span>
        <span class="n">flatten_offset</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">observations</span><span class="p">))[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span>
        <span class="n">flat_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">observations</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">reachable_state_count</span><span class="p">))</span>

        <span class="n">a</span><span class="o">=</span><span class="n">reachable_state_per_actions</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">flat_shape</span><span class="p">)</span>
        <span class="n">w</span><span class="o">=</span><span class="n">reachable_probabilities</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">flat_shape</span><span class="p">)</span>

        <span class="n">a_offs</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">flatten_offset</span>
        <span class="n">new_probabilities</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">a_offs</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">weights</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">minlength</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span><span class="p">))</span>

        <span class="c1"># Normalization</span>
        <span class="n">probability_sum</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">new_probabilities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">xp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">probability_sum</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">throw_error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;One or more belief is impossible, (ie the sum of the probability distribution is 0)&#39;</span><span class="p">)</span>
        <span class="n">non_zero_mask</span> <span class="o">=</span> <span class="n">probability_sum</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="n">new_probabilities</span><span class="p">[</span><span class="n">non_zero_mask</span><span class="p">]</span> <span class="o">/=</span> <span class="n">probability_sum</span><span class="p">[</span><span class="n">non_zero_mask</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">new_probabilities</span><span class="p">)</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">unique_belief_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        A dictionary of unique belief points with the keys being the byte representation of these belief points.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uniqueness_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_uniqueness_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">belief</span><span class="o">.</span><span class="n">bytes_repr</span><span class="p">:</span> <span class="n">belief</span> <span class="k">for</span> <span class="n">belief</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">belief_list</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_uniqueness_dict</span>


    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_belief_set</span><span class="p">:</span><span class="s1">&#39;BeliefSet&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BeliefSet&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function to make the union between two belief set objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other_belief_set : BeliefSet</span>
<span class="sd">            The other belief set to make the union with</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        new_belief_set : BeliefSet</span>
<span class="sd">            A new, combined, belief set</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Deduplication</span>
        <span class="n">combined_uniqueness_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_belief_dict</span> <span class="o">|</span> <span class="n">other_belief_set</span><span class="o">.</span><span class="n">unique_belief_dict</span>

        <span class="c1"># Generation of new set</span>
        <span class="n">new_belief_set</span> <span class="o">=</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">combined_uniqueness_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
        <span class="n">new_belief_set</span><span class="o">.</span><span class="n">_uniqueness_dict</span> <span class="o">=</span> <span class="n">combined_uniqueness_dict</span>

        <span class="k">return</span> <span class="n">new_belief_set</span>


    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entropies</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        An array of the entropies of the belief points.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">gpu_support</span> <span class="k">else</span> <span class="n">cp</span><span class="o">.</span><span class="n">get_array_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belief_array</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">entropy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belief_array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">xp</span> <span class="o">==</span> <span class="n">np</span> <span class="k">else</span> <span class="n">cupy_entropy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">belief_array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">to_gpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BeliefSet&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function returning an equivalent belief set object with the array of values stored on GPU instead of CPU.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gpu_belief_set : BeliefSet</span>
<span class="sd">            A new belief set with array on GPU.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">assert</span> <span class="n">gpu_support</span><span class="p">,</span> <span class="s2">&quot;GPU support is not enabled, unable to execute this function&quot;</span>

        <span class="n">gpu_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">gpu_model</span>

        <span class="n">gpu_belief_set</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gpu_belief_array</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span><span class="p">)</span>
            <span class="n">gpu_belief_set</span> <span class="o">=</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="n">gpu_model</span><span class="p">,</span> <span class="n">gpu_belief_array</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gpu_belief_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Belief</span><span class="p">(</span><span class="n">gpu_model</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span><span class="p">]</span>
            <span class="n">gpu_belief_set</span> <span class="o">=</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="n">gpu_model</span><span class="p">,</span> <span class="n">gpu_belief_list</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">gpu_belief_set</span>


    <span class="k">def</span> <span class="nf">to_cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BeliefSet&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Function returning an equivalent belief set object with the array of values stored on CPU instead of GPU.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cpu_belief_set : BeliefSet</span>
<span class="sd">            A new belief set with array on CPU.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">assert</span> <span class="n">gpu_support</span><span class="p">,</span> <span class="s2">&quot;GPU support is not enabled, unable to execute this function&quot;</span>

        <span class="n">cpu_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cpu_model</span>

        <span class="n">cpu_belief_set</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cpu_belief_array</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span><span class="p">)</span>
            <span class="n">cpu_belief_set</span> <span class="o">=</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="n">cpu_model</span><span class="p">,</span> <span class="n">cpu_belief_array</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">cpu_belief_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Belief</span><span class="p">(</span><span class="n">cpu_model</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span><span class="p">]</span>
            <span class="n">cpu_belief_set</span> <span class="o">=</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="n">cpu_model</span><span class="p">,</span> <span class="n">cpu_belief_list</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">cpu_belief_set</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="olfactory_navigation.agents.model_based_util.belief.BeliefSet.belief_array" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">belief_array</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>A matrix of size N x S containing N belief vectors. If belief set is stored as a list of Belief objects, the matrix of beliefs will be generated from them.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="olfactory_navigation.agents.model_based_util.belief.BeliefSet.belief_list" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">belief_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Belief</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>A list of Belief objects. If the belief set is represented as a matrix of Belief vectors, the list of Belief objects will be generated from it.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="olfactory_navigation.agents.model_based_util.belief.BeliefSet.entropies" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">entropies</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>An array of the entropies of the belief points.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="olfactory_navigation.agents.model_based_util.belief.BeliefSet.unique_belief_dict" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">unique_belief_dict</span><span class="p">:</span> <span class="nb">dict</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>A dictionary of unique belief points with the keys being the byte representation of these belief points.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="olfactory_navigation.agents.model_based_util.belief.BeliefSet.generate_all_successors" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_all_successors</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Function to generate the successors beliefs of all the beliefs in the belief set.</p>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>all_successors</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.BeliefSet" href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet">BeliefSet</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>All successors of all beliefs in the belief set.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_all_successors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BeliefSet&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to generate the successors beliefs of all the beliefs in the belief set.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    all_successors : BeliefSet</span>
<span class="sd">        All successors of all beliefs in the belief set.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">all_successors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">belief</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">belief_list</span><span class="p">:</span>
        <span class="n">all_successors</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">belief</span><span class="o">.</span><span class="n">generate_successors</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">all_successors</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="olfactory_navigation.agents.model_based_util.belief.BeliefSet.to_cpu" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_cpu</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Function returning an equivalent belief set object with the array of values stored on CPU instead of GPU.</p>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>cpu_belief_set</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.BeliefSet" href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet">BeliefSet</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new belief set with array on CPU.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_cpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BeliefSet&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function returning an equivalent belief set object with the array of values stored on CPU instead of GPU.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    cpu_belief_set : BeliefSet</span>
<span class="sd">        A new belief set with array on CPU.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">assert</span> <span class="n">gpu_support</span><span class="p">,</span> <span class="s2">&quot;GPU support is not enabled, unable to execute this function&quot;</span>

    <span class="n">cpu_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cpu_model</span>

    <span class="n">cpu_belief_set</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cpu_belief_array</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span><span class="p">)</span>
        <span class="n">cpu_belief_set</span> <span class="o">=</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="n">cpu_model</span><span class="p">,</span> <span class="n">cpu_belief_array</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">cpu_belief_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Belief</span><span class="p">(</span><span class="n">cpu_model</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span><span class="p">]</span>
        <span class="n">cpu_belief_set</span> <span class="o">=</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="n">cpu_model</span><span class="p">,</span> <span class="n">cpu_belief_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cpu_belief_set</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="olfactory_navigation.agents.model_based_util.belief.BeliefSet.to_gpu" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_gpu</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Function returning an equivalent belief set object with the array of values stored on GPU instead of CPU.</p>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>gpu_belief_set</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.BeliefSet" href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet">BeliefSet</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new belief set with array on GPU.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_gpu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BeliefSet&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function returning an equivalent belief set object with the array of values stored on GPU instead of CPU.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gpu_belief_set : BeliefSet</span>
<span class="sd">        A new belief set with array on GPU.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">assert</span> <span class="n">gpu_support</span><span class="p">,</span> <span class="s2">&quot;GPU support is not enabled, unable to execute this function&quot;</span>

    <span class="n">gpu_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">gpu_model</span>

    <span class="n">gpu_belief_set</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gpu_belief_array</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_belief_array</span><span class="p">)</span>
        <span class="n">gpu_belief_set</span> <span class="o">=</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="n">gpu_model</span><span class="p">,</span> <span class="n">gpu_belief_array</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gpu_belief_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Belief</span><span class="p">(</span><span class="n">gpu_model</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_belief_list</span><span class="p">]</span>
        <span class="n">gpu_belief_set</span> <span class="o">=</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="n">gpu_model</span><span class="p">,</span> <span class="n">gpu_belief_list</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gpu_belief_set</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="olfactory_navigation.agents.model_based_util.belief.BeliefSet.union" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">union</span><span class="p">(</span><span class="n">other_belief_set</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Function to make the union between two belief set objects.</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>other_belief_set</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.BeliefSet" href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet">BeliefSet</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The other belief set to make the union with</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>new_belief_set</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.BeliefSet" href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet">BeliefSet</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A new, combined, belief set</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_belief_set</span><span class="p">:</span><span class="s1">&#39;BeliefSet&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BeliefSet&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Function to make the union between two belief set objects.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    other_belief_set : BeliefSet</span>
<span class="sd">        The other belief set to make the union with</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_belief_set : BeliefSet</span>
<span class="sd">        A new, combined, belief set</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Deduplication</span>
    <span class="n">combined_uniqueness_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unique_belief_dict</span> <span class="o">|</span> <span class="n">other_belief_set</span><span class="o">.</span><span class="n">unique_belief_dict</span>

    <span class="c1"># Generation of new set</span>
    <span class="n">new_belief_set</span> <span class="o">=</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">combined_uniqueness_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    <span class="n">new_belief_set</span><span class="o">.</span><span class="n">_uniqueness_dict</span> <span class="o">=</span> <span class="n">combined_uniqueness_dict</span>

    <span class="k">return</span> <span class="n">new_belief_set</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="olfactory_navigation.agents.model_based_util.belief.BeliefSet.update" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="n">actions</span><span class="p">,</span> <span class="n">observations</span><span class="p">,</span> <span class="n">throw_error</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns a new belief based on this current belief, the most recent action (a) and the most recent observation (o).</p>



  <p><span class="doc-section-title">Parameters:</span></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
          <td><code>actions</code></td>
          <td>
                <code>list or <span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The most recent played actions.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>observations</code></td>
          <td>
                <code>list or <span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The most recent received observations.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr class="doc-section-item">
          <td><code>throw_error</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the throw an error when attempting to generate impossible beliefs.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><span class="doc-section-title">Returns:</span></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr class="doc-section-item">
<td><code>new_belief_set</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="olfactory_navigation.agents.model_based_util.belief.BeliefSet" href="#olfactory_navigation.agents.model_based_util.belief.BeliefSet">BeliefSet</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An set of updated beliefs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>olfactory_navigation\agents\model_based_util\belief.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
           <span class="n">actions</span><span class="p">:</span><span class="nb">list</span><span class="o">|</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
           <span class="n">observations</span><span class="p">:</span><span class="nb">list</span><span class="o">|</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
           <span class="n">throw_error</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span>
           <span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;BeliefSet&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns a new belief based on this current belief, the most recent action (a) and the most recent observation (o).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    actions : list or np.ndarray</span>
<span class="sd">        The most recent played actions.</span>
<span class="sd">    observations : list or np.ndarray</span>
<span class="sd">        The most recent received observations.</span>
<span class="sd">    throw_error : bool, default=True</span>
<span class="sd">        Whether the throw an error when attempting to generate impossible beliefs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    new_belief_set : BeliefSet</span>
<span class="sd">        An set of updated beliefs.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># GPU support check</span>
    <span class="n">xp</span> <span class="o">=</span> <span class="n">cp</span> <span class="k">if</span> <span class="p">(</span><span class="n">gpu_support</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_on_gpu</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span>

    <span class="c1"># Ensuring we are dealing we are dealing with ndarrays</span>
    <span class="n">observations</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">observations</span><span class="p">)</span>
    <span class="n">actions</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>

    <span class="c1"># Computing reachable probabilities and states</span>
    <span class="n">reachable_probabilities</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">reachable_transitional_observation_table</span><span class="p">[:,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">observations</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">belief_array</span><span class="o">.</span><span class="n">T</span><span class="p">[:,:,</span><span class="kc">None</span><span class="p">])</span>
    <span class="n">reachable_state_per_actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">reachable_states</span><span class="p">[:,</span> <span class="n">actions</span><span class="p">,</span> <span class="p">:]</span>

    <span class="c1"># Computing new probabilities</span>
    <span class="n">flatten_offset</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">observations</span><span class="p">))[:,</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span>
    <span class="n">flat_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">observations</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">reachable_state_count</span><span class="p">))</span>

    <span class="n">a</span><span class="o">=</span><span class="n">reachable_state_per_actions</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">flat_shape</span><span class="p">)</span>
    <span class="n">w</span><span class="o">=</span><span class="n">reachable_probabilities</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">flat_shape</span><span class="p">)</span>

    <span class="n">a_offs</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">flatten_offset</span>
    <span class="n">new_probabilities</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">a_offs</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">weights</span><span class="o">=</span><span class="n">w</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">minlength</span><span class="o">=</span><span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">state_count</span><span class="p">))</span>

    <span class="c1"># Normalization</span>
    <span class="n">probability_sum</span> <span class="o">=</span> <span class="n">xp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">new_probabilities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">xp</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">probability_sum</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">throw_error</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;One or more belief is impossible, (ie the sum of the probability distribution is 0)&#39;</span><span class="p">)</span>
    <span class="n">non_zero_mask</span> <span class="o">=</span> <span class="n">probability_sum</span> <span class="o">!=</span> <span class="mi">0</span>
    <span class="n">new_probabilities</span><span class="p">[</span><span class="n">non_zero_mask</span><span class="p">]</span> <span class="o">/=</span> <span class="n">probability_sum</span><span class="p">[</span><span class="n">non_zero_mask</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">BeliefSet</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">new_probabilities</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: model_based_util">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                model_based_util
              </div>
            </div>
          </a>
        
        
          
          <a href="../belief_value_mapping/" class="md-footer__link md-footer__link--next" aria-label="Next: belief_value_mapping">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                belief_value_mapping
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.footer", "navigation.expand", "navigation.path", "navigation.top", "navigation.tabs"], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.5cfa9459.min.js"></script>
      
    
  </body>
</html>